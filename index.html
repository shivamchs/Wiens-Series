<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Wein's Series Bridge</title>
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0" />

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

  <script src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
    integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
    crossorigin="anonymous"></script>

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  <script src="jsplumb.min.js"></script>
  <script async="true" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=AM_CHTML"> </script>
  <script async="true" src="https://cdn.jsdelivr.net/npm/mathjax@2.7.6/MathJax.js?config=AM_CHTML"> </script>
  <script async="true" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=AM_CHTML"> </script>




  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@7.12.15/dist/sweetalert2.all.min.js"></script>

  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
    integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

  <style>
    #diagram,
    #toolbox {
      margin: 20px 0;
      border-width: 2px;
      border-style: solid;
      border-color: black;
      height: 960px;
    }

    #toolbox {
      display: flex;
      padding: 10px;
      flex-flow: row wrap;
      align-content: flex-start;
    }

    .control {
      border-color: black;
      border-radius: 10px;
      border-width: 2px;
      border-style: solid;
      width: 60px;
      text-align: center;
      cursor: move;
      height: fit-content;
      height: -moz-max-content;
      background-color: white;
    }

    #diagram .control {
      position: absolute;
    }

    .window {
      z-index: 20;
    }

    .jtk-connector {
      z-index: 4;
    }

    .jtk-endpoint {
      z-index: 5;
    }

    .jtk-overlay {
      z-index: 6;
    }

    .custom-menu {
      z-index: 1000;
      position: absolute;
      background-color: #C0C0C0;
      border: 1px solid black;
      padding: 0px;
    }

    #toolbox .control {
      margin: 10px 5px;
    }


    #instruction {
      margin: 20px 0px;
      border-width: 2px;
      /* border-style: solid;
          border-color: lightgrey; */
      height: 998px;
      width: 2000px;
    }

    #inst {
      height: 70vh;

    }



    .black_overlay {
      display: none;
      position: absolute;
      top: 0%;
      left: 0%;
      width: 100%;
      height: 90%;
      background-color: black;
      z-index: 1001;
      -moz-opacity: 0.8;
      opacity: .80;
      filter: alpha(opacity=80);
    }

    .white_content {
      display: none;
      position: absolute;
      top: 10%;
      left: -148%;
      width: 137%;
      height: 65%;
      padding: 8px;
      border: 1px solid #808080;
      background-color: white;
      z-index: 1002;
      overflow: auto;
      box-shadow: 10px 11px 23px #212529;
    }



    table,
    th,
    td {
      border: 1px solid black;

    }

    #myTable {
      border: 1px solid black;
      width: 250px;
      height: 10%;
    }

    @import url('https://fonts.cdnfonts.com/css/seven-segment');


    .no-pointer-events {
      pointer-events: none;
    }


    .slidecontainer {
      width: 100%;
    }

    .slider {
      appearance: none;
      width: 100%;
      height: 25px;
      background: #d3d3d3;
      outline: none;
      opacity: 0.7;
      -webkit-transition: .2s;
      transition: opacity .2s;
    }

    .slider:hover {
      opacity: 1;
    }

    .slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 25px;
      height: 25px;
      background: #04AA6D;
      cursor: pointer;
    }

    .slider::-moz-range-thumb {
      width: 25px;
      height: 25px;
      background: #04AA6D;
      cursor: pointer;
    }
  </style>

</head>

<body>
  <div style="position: absolute;border: 2px solid black;    top: -32px;">
    <div class="container-fluid">
      <div style="position:relative;    top: 65em;left:-1em;color:white;background-color: #cb3535;width: 101.6%;text-align: center;height: 33px;
  padding: 5px;">
        Copyright&copy;2023 | Lab developed by Virtual Labs, IIT Roorkee</div>
      <div class="row">
        <div class="col-md-2">
          <h3 style="    position: absolute;
      border: 2px solid black;
      width: 323px;
      text-align: center;background-color: #cb3535;color: white;border-radius: 6px;
  ">Components</h3>
          <div id="toolbox" class="justify-content-center" style="    position: absolute;
      top: 20px;
      width: 323px;
      height: 204px;
  ">
            <div class="control r"><img src="resistor.png" width="50px" height="50px"></div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <div class="control v"><img src="voltage_ac.png" width="50px" height="50px"> </div>&nbsp;&nbsp;&nbsp;&nbsp;

            <div class="control g"><img src="headphone.jpg" width="50px" height="50px"></div>&nbsp;&nbsp;
            <div class="control c"><img src="capacitor.png" width="50px" height="50px"></div>
            <h3 style="    position: absolute;
        border: 2px solid black;
        width: 323px;
        text-align: center;background-color: #cb3535;color: white;border-radius: 6px;top: 216px;
    ">Formulae</h3>
            <div id="formulae" style="    position: absolute;
        top: 258px;
        padding: 2px;border: 2px solid black;        height: 700.8px; width:330px;
">

              <!-- <p>C1=Capacitor whose capacitance is to be measured,<br>

                R1
                = A series resistance representing the loss in the capacitor C1
                ,<br>

                C4
                = A standard capacitance with series resistance of R4
                ,<br>

                R2
                and R3
                = Non-inductive resistances.</p>

              <h5>At Balance: </h5>




              <br>

              <p>Equating the real and imaginary terms, </p>
              <img src="ws.png" alt="" height="350" width="300"> -->



              <p>C1=Capacitor whose capacitance is to be measured,<br>

                R1
                = A series resistance representing the loss in the capacitor C1
                ,<br>

                C2
                = A standard capacitance with series resistance of R2
                ,<br>

                R3
                and R4
                = Non-inductive resistances.</p>

              <h5>At Balance: </h5>


              <br>

              <p>Equating the real and imaginary terms, </p>



              <script type="math/asciimath"
                id="MathJax-Element-8">(R_1+ 1/(jomegaC_1)) * R_4 = (R_2 + 1/(jomegaC_2))* R_3</script><br><br>

              <script type="math/asciimath" id="MathJax-Element-10">R_1R_4 = R_2R_3</script>
              <br><br>
              <script type="math/asciimath" id="MathJax-Element-11">R_1 = (R_3R_2)/R_4</script>
              <br><br>

              <script type="math/asciimath"
                id="MathJax-Element-12">(1/ (jomegaC_1)) * R_4 = (1/ (jomegaC_2)) * R_3</script><br>
              <br>



              <p>Measure capacitance value is</p>
              <script type="math/asciimath" id="MathJax-Element-14">C_1 =(C_2R_4)/R_3</script>









              <!-- <script type="math/asciimath" id="MathJax-Element-8">(R_1 + 1/ (jomegaC_1)) * R_3 = (R_4 + 1/ (jomegaC_4)) * R_2</script><br><br>

<script type="math/asciimath" id="MathJax-Element-10">R_1R_3 = R_2R_4</script>
<br><br>
<script type="math/asciimath" id="MathJax-Element-11">R_1 = (R_2R_4)/R_3</script>
<br><br>

<script type="math/asciimath" id="MathJax-Element-12">(1/ (jomegaC_1)) * R_3 = (1/ (jomegaC_4)) * R_2</script><br>
<br>



<p>Measure capacitance value is</p>
<script type="math/asciimath" id="MathJax-Element-14">C_1 =(C_4R_3)/R_2</script>  -->


            </div>
          </div>
        </div>
        <div class="col-md-7">
          <h3 style="    position: absolute;
      border: 2px solid black;
      border-radius: 6px;
      width: 96.4%;
      text-align: center;right: 25px;background-color: #cb3535;color: white;
  ">WorkSpace</h3>
          <div id="diagram" style="height: 960px; position: absolute;width: 96.4%;top: 20px;right: 25px;">
            <button class="btn btn-danger" style="bottom: 17px;
        right: 700px;
    position: absolute;">Check Circuit</button>  

    
          </div>


          <div id="digital-m" style="background-color:rgb(7, 7, 7); width: 120px; height: 50px; ;border:inset 6px lightgray;position:absolute;    top: 51px;
      left: 1442px; ">
            <b>
              <p id="digi"
                style="text-align: center; margin:5px; font-size:1.5rem; font-family:'Seven Segment'sans-serif;color:crimson;">
                --.--</p>
            </b>
          </div>





        </div>

        <div class="col-md-3" id="instruction">
          <div id="inst">



            <p style="    position: relative;
                top: 30px;
    right: 167px;"><a href="javascript:void(0)"
                onclick="document.getElementById('light').style.display='block';document.getElementById('fade').style.display='none'"
                class="btn btn-danger"><b>Instructions</b></a>
            </p>
            <div id="light" class="white_content"><b>Wien's Series Bridge Experiment</b><br>
              <div align="center"><img src="wien series.jpg" width="300px" height="300px"></div>

              <ul><b>STEP 1:</b> Pick up four resistances, two capacitors, a battery and a headphone from the
                Components.</ul>
              <ul><b>STEP 2:</b> Connect the resistances, capacitors and the battery as shown in the figure to form a Wein series bridge.</ul>
                <ul><b>STEP 3:</b> Click on check circuit button to check the connections.</ul>
              <ul><b>STEP 4:</b> Now Enter the values of R1, R2, R3, R4 and the value of voltage and choose appropriate value of frequency and click on the <b>"Submit"</b> button.</ul>
              <ul><b>STEP 5:</b> Repeat the experiment until the bridge gets balanced.</ul>
              <hr>
              <a href="javascript:void(0)"
                onclick="document.getElementById('light').style.display='none';document.getElementById('fade').style.display='none'"
                class="btn btn-outline-danger" style="    position: absolute;
        top: 20px;
        right: 20px;"><span style="    padding-top: 6px;" class="material-symbols-outlined">
                  close
                </span></a>
            </div>
            <div id="fade" class="black_overlay"></div>

            <!-- <p><a href="javascript:void(0)" onclick="document.getElementById('light2').style.display='block';document.getElementById('fade').style.display='block'"><b>Observations</b></a>
      </p> -->
            <!-- <div id="light2" class="white_content"><b>Observation Table</b><br>
              <table id="myTable">
                <tr>
                  <th>R1</th>
                  <th>R2</th>
                  <th>R3</th>
                  <th>R4</th>
                  <th>V</th>
                  <th>C</th>
                </tr>
              </table>
              <a href="javascript:void(0)"
                onclick="document.getElementById('light2').style.display='none';document.getElementById('fade').style.display='none'">Close</a>
            </div>
            <div id="fade" class="black_overlay"></div> -->




            <!-- <p><a href="javascript:void(0)" onclick="document.getElementById('light1').style.display='block';document.getElementById('fade').style.display='block'" style="position: absolute;bottom: 2px;"><b>Formulae</b></a>
      </p> -->
            <div id="light1" class="white_content"><b>Wien's Series Bridge Experiment</b><br>




              <!-- <div id="formulae">


                <p>C1=Capacitor whose capacitance is to be measured,<br>

                  R1
                  = A series resistance representing the loss in the capacitor C1
                  ,<br>

                  C2
                  = A standard capacitance with series resistance of R2
                  ,<br>

                  R3
                  and R4
                  = Non-inductive resistances.</p>

                <h5>At Balance: </h5>


                <br>

                <p>Equating the real and imaginary terms, </p>



                <script type="math/asciimath"
                  id="MathJax-Element-8">(R_1 + 1/ (jomegaC_1)) * R_4 = (R_2 + 1/ (jomegaC_2)) * R_3</script><br><br>

                <script type="math/asciimath" id="MathJax-Element-10">R_1R_4 = R_2R_3</script>
                <br><br>
                <script type="math/asciimath" id="MathJax-Element-11">R_1 = (R_3R_2)/R_4</script>
                <br><br>

                <script type="math/asciimath"
                  id="MathJax-Element-12">(1/ (jomegaC_1)) * R_4 = (1/ (jomegaC_2)) * R_3</script><br>
                <br>



                <p>Measure capacitance value is</p>
                <script type="math/asciimath" id="MathJax-Element-14">C_1 =(C_2R_4)/R_3</script>


              </div> -->


              <a href="javascript:void(0)"
                onclick="document.getElementById('light1').style.display='none';document.getElementById('fade').style.display='none'">Close</a>
            </div>
            <div id="fade" class="black_overlay"></div>
            <h3 style="    position: relative;
      border: 2px solid black;
      width: 446px;
      text-align: center;background-color: #cb3535;color: white;border-radius: 6px;    right: 23px;
    top: -74px;
  ">Calculations</h3>




            <div id="mydiv" style="display:block;border: 2px solid black; padding: 20px;      width: 92.5%;
      position: relative;
      top: -78px;
      right: 25px;">
              <br>
              <p>
              <h3 style="    position: absolute;
          top: 20px;">C2 = 0.001 &#181;F</h3>
              </p><br>
              <form action="#" onsubmit="yourJsFunction();return false">
                <div class="slidecontainer">

                  &nbsp;<b>R1 : 1Ω</b>
                  <!-- <span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mstyle displaystyle=&quot;true&quot;><mo>&amp;#x2126;</mo></mstyle></math>" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-134" style="width: 0.792em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.731em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.217em, 1000.67em, 2.309em, -999.997em); top: -2.121em; left: 0em;"><span class="mrow" id="MathJax-Span-135"><span class="mstyle" id="MathJax-Span-136"><span class="mrow" id="MathJax-Span-137"><span class="mo" id="MathJax-Span-138" style="font-family: MathJax_Main;">Ω</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.127em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true"><mo>Ω</mo></mstyle></math></span></span>
            <script type="math/asciimath" id="MathJax-Element-23">Ω</script>
            &nbsp;  -->


                  <input type="range" min="1" max="1000" value="1" id="myRange1" step="0.05"
                    onchange="data1.value=this.value; document.getElementById('r1_tag0').innerHTML='R1 = '+this.value+'&nbsp;Ω'"
                    style="width: 110px">&nbsp; <b>1 KΩ</b>&nbsp;&nbsp;
                  <input type="number" name="data1" id="data1" step="0.05"
                    onchange="myRange1.value=this.value; document.getElementById('r1_tag0').innerHTML='R1 = '+this.value+'&nbsp;Ω'"
                    style="width: 60px; height:20px">





                </div>
                <br>

                <div class="slidecontainer">
                  &nbsp;<b>R2 : 1Ω</b>&nbsp;
                  <input type="range" min="1" max="1000" value="1" id="myRange2" step="0.05"
                    onchange="data2.value=this.value; document.getElementById('r1_tag1').innerHTML='R2 = '+this.value+'&nbsp;Ω'"
                    style="width: 110px">&nbsp;<b>1 KΩ</b>&nbsp;&nbsp;
                  <input type="number" name="data2" id="data2" step="0.05"
                    onchange="myRange2.value=this.value; document.getElementById('r1_tag1').innerHTML='R2 = '+this.value+'&nbsp;Ω'"
                    style="width: 60px; height:20px">
                </div>
                <br>

                <div class="slidecontainer">
                  &nbsp;<b>R3 : 1Ω</b>
                  <input type="range" min="1" max="1000" value="1" id="myRange" step="0.05"
                    onchange="data6.value=this.value; document.getElementById('r1_tag2').innerHTML='R3 = '+this.value+'&nbsp;Ω'"
                    style="width: 110px">&nbsp; <b>1 KΩ</b>&nbsp;&nbsp;
                  <input type="number" name="data6" id="data6" step="0.05"
                    onchange="myRange.value=this.value; document.getElementById('r1_tag2').innerHTML='R3 = '+this.value+'&nbsp;Ω'"
                    style="width: 60px; height:20px">
                </div>
                <br>


                <div class="slidecontainer">
                  &nbsp;<b>R4 : 1Ω</b>&nbsp;
                  <input type="range" min="1" max="1000" value="1" id="myRange3" step="0.05"
                    onchange="data4.value=this.value; document.getElementById('r1_tag3').innerHTML='R4 = '+this.value+'&nbsp;Ω'"
                    style="width: 110px">&nbsp;<b>1 KΩ</b>&nbsp;&nbsp;
                  <input type="number" name="data4" id="data4" step="0.05"
                    onchange="myRange3.value=this.value; document.getElementById('r1_tag3').innerHTML='R4 = '+this.value+'&nbsp;Ω'"
                    style="width: 60px; height:20px">
                </div>
                <br>

                <p><b>V:</b>&nbsp;&nbsp;<input type="number" id="data5" style="width: 60px;">&nbsp;&nbsp;&nbsp;
                  <b>f:</b>&nbsp;&nbsp; <input type="number" id="data7" style="width: 60px;">
                </p>
                <br>



                <input class="btn btn-success
          " id="btn1" type="submit" disabled />

              </form>


            </div>
            <h3 style="position:relative;
      border: 2px solid black;
      width: 458px;
      text-align: center;background-color: #cb3535;color: white;border-radius: 6px;right: 31px;
    top: -64px;
  ">Observation Table</h3>
            <table id="myTable" style="    position: relative;
          top: -68px;
    border: 2px solid black!important;
    right: 31px;
   width: 94.5%;
       height: 50px;text-align: center;" class="table table-bordered">
              <tr>
                <th>R1(&#8486;)</th>
                <th>R2(&#8486;)</th>
                <th>R3(&#8486;)</th>
                <th>R4(&#8486;)</th>
                <th>Voltage(V)</th>
                <th>C(&#181;F)</th>
              </tr>
            </table>

            <div id="abcde" style="    position: absolute;
    top: 924px;
    left: -550px;">
              <button onClick="window.location.reload();" class="btn btn-warning" style="width: 120px;    position: absolute;
      right: 151px;">Reset</button>
              <button onClick="window.print();" class="btn btn-primary" style="width: 120px;">Print </button>
            </div>

          </div>

        </div>


      </div>

    </div>
  </div>
  <script>

    function touchHandler(event) {
      var touch = event.changedTouches[0];
  
      var simulatedEvent = document.createEvent("MouseEvent");
          simulatedEvent.initMouseEvent({
          touchstart: "mousedown",
          touchmove: "mousemove",
          touchend: "mouseup"
      } [event.type], true, true, window, 1,
          touch.screenX, touch.screenY,
          touch.clientX, touch.clientY, false,
          false, false, false, 0, null);
  
      touch.target.dispatchEvent(simulatedEvent);
      
  }
  
  function init() {
      document.addEventListener("touchstart", touchHandler, true);
      document.addEventListener("touchmove", touchHandler, true);
      document.addEventListener("touchend", touchHandler, true);
      document.addEventListener("touchcancel", touchHandler, true);
  }
  init();









    const mydiv = document.getElementById('mydiv');
    var data4 = 1; let c_ratio = 1;


    function yourJsFunction() {
      //mydiv.style.display="none";

      var data1 = document.getElementById("data1").value;
      var data2 = document.getElementById("data2").value;
      var data4 = document.getElementById("data4").value;
      var data5 = document.getElementById("data5").value;
      var data3 = document.getElementById("data6").value;


      if (data1 == "" || data2 == "" || data4 == "" || data5 == "") {
        swal("Fill empty values");

        return;
      }






      if (data1 <= 0 || data2 <= 0 || data4 <= 0 || data5 <= 0) {
        swal("Invalid Values");

        return;
      }
      // Create a new table row for each input value

      var row = document.createElement("tr");
      var cur = c_ratio * 0.001;







      const arr = [data1, data2, data3, data4, data5];

      console.log(data3);
      
      if (Math.abs(c_ratio - ( data4/ data3))<0.1 && Math.abs(c_ratio - (data2 / data1))<0.1) {
        // document.getElementById("light1").innerHTML+=`<h4>Bridge is Balanced</h4>
        // <h5>Equivalent Resistance:</h5><b> `+ frac(1)(r1+r3)+ ` </b>`;
        document.getElementById("digi").innerHTML = 0;

        swal("Balanced Bridge");
        //console.log("x1111");
        for (var i = 1; i <= 5; i++) {
          // Get the value of the current input field
          var data = arr[i-1];
  
          // Create a new table row element
  
          // Create a new table data element
          var cell = document.createElement("td");
          cell.innerHTML = data;
  
          // Add the table data to the table row
          row.appendChild(cell);
  
          // Add the table row to the table
          document.getElementById("myTable").appendChild(row);
        }
  
      cur=(data4/data3)*0.001;
      cur=cur.toFixed(4);
      var cell = document.createElement("td");
      cell.innerHTML = cur+"uF";
      row.appendChild(cell);
      document.getElementById("myTable").appendChild(row);

      }


      else if (Math.abs(c_ratio -  (data4/ data3))<0.1) {
        var res=(( data2/ data1)-c_ratio);
        document.getElementById("digi").innerHTML = res;
        var audio = new Audio('audio2_detector.mp3');
        audio.play();
        audio.volume = 0.2;
        swal("Unbalanced...Fix Ratio R2/R1");
        audio.addEventListener("canplaythrough", function () {
          setTimeout(function () {
            audio.pause();
          },
            5000);
        }, false);

      }
      else if(Math.abs(c_ratio - (data2 / data1))<0.1){
        var res=(( data4/ data3)-c_ratio );
        document.getElementById("digi").innerHTML = res;

        var audio = new Audio('audio2_detector.mp3');
        audio.play();
        audio.volume = 0.2;
        swal("Unbalanced...Fix Ratio R4/R3");
        audio.addEventListener("canplaythrough", function () {
          setTimeout(function () {
            audio.pause();
          },
            5000);
        }, false);

      }

      else {
        var res = Math.max((c_ratio - (data2 / data1)) / 100, (c_ratio - (data4 / data3)) / 100);
      res = res.toFixed(3);
      document.getElementById("digi").innerHTML = res;

        var audio = new Audio('audio1_detector.mp3');
        audio.play();
        audio.volume = 0.1;
        swal("Unbalanced");
        audio.addEventListener("canplaythrough", function () {
          setTimeout(function () {
            audio.pause();
          },
            3000);
        }, false);

      }
    }




    var count1 = 1, count2 = 1, count3 = 1, count4 = 1;
    // https://stackoverflow.com/a/2117523
    function uuidv4() {
      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
        var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
        return v.toString(16);
      });
    }
    instance = jsPlumb.getInstance({});
    instance.setContainer("diagram");
    instance.bind("ready", function () {
      instance.registerConnectionTypes({
        "red-connection": {
          paintStyle: { stroke: "blue", strokeWidth: 3 },
          hoverPaintStyle: { stroke: "blue", strokeWidth: 6},
          connector: "Flowchart"
        }
      });
      /*instance.draggable("control1", {"containment": true});
      instance.draggable("control2", {"containment": true})
      instance.addEndpoint("control1", {
        endpoint: "Dot",  // rectangle, blank, image
        anchor: ["RightMiddle"],
        isSource: true,
        connectionType: "red-connection"
      });
      instance.addEndpoint("control2", {
        endpoint: "Dot",
        anchor: ["LeftMiddle"],
        isTarget: true,
        connectionType: "red-connection"
      });*/

      // https://stackoverflow.com/a/4502207

      $(document).bind("click", function (event) {
        $("div.custom-menu").remove();
      });

      $("body").on("contextmenu", "#diagram .control", function (event) {
        event.preventDefault();
        window.selectedControl = $(this).attr("id");
        console.log(window.selectedControl);
        $("<div class='custom-menu'><button class='delete-control'>Delete control</button></div>")
          .appendTo("body")
          .css({ top: event.pageY + "px", left: event.pageX + "px" });








      });



      $("body").on("click", ".delete-control", function (event) {
        instance.remove(window.selectedControl);

      });

      $("#toolbox .control").draggable({
        helper: "clone",
        containment: ".body",
        appendTo: "#diagram"
      });


      $("#diagram").droppable({
        drop: function (event, ui) {
          var id;
          var clone = $(ui.helper).clone(true);
          var s = clone.attr("class");
          if (s[8] == 'r') {
            id = s[8] + count1.toString();
            count1++;
          }
          else if (s[8] == 'v') {
            id = s[8] + count2.toString();
            count2++;
          }
          else if (s[8] == 'g') {
            id = s[8] + count3.toString();
            count3++;
          }
          else if (s[8] == 'c') {
            id = s[8] + count4.toString();
            count4++;
          }


          clone.attr("id", id);
          clone.appendTo(this);


          /*
          var id1=id+'d';
          console.log(id1);
          var id2=id+'div';
          var left_p=clone.position().left;
          var top_p=clone.position().top;
          $("<div id="+id2+" style = 'position: relative;top:"+top_p +"px ; left:"+ left_p+"px ;'><form><input type='number' placeholder='Value' id="+ id1 +" style='width: 100px;'></form></div>")
          .appendTo("#diagram");
        var button = document.getElementById(id);
        var myDiv = document.getElementById(id2);
  
        function show() {
            myDiv.style.visibility = "visible";
        }
  
        function hide() {
            myDiv.style.visibility = "hidden";
        }
  
        function toggle() {
            if (myDiv.style.visibility === "hidden") {
                show();
            } else {
                hide();
            }
        }
  
        hide();
  
        button.addEventListener("click", toggle, false);
  
  */





          instance.draggable(id, { containment: true });


          if (id[0] == 'v') {

            instance.addEndpoint(id, {
              endpoint: ["Dot", { radius: 6 }], maxConnections: 2,
              anchor: ["Left"],
              isSource: true, paintStyle: { fill: "red" },
              connectionType: "red-connection"
            });

            instance.addEndpoint(id, {
              endpoint: ["Dot", { radius: 6 }], maxConnections: 2,
              anchor: ["Right"],
              isTarget: true,
              connectionType: "red-connection"
            });

          }
          else if (id[0] == 'g') {
            instance.addEndpoint(id, {
              endpoint: ["Dot", { radius: 6 }],
              anchor: ["Left"],
              isTarget: true,
              connectionType: "red-connection"
            });

            instance.addEndpoint(id, {
              endpoint: ["Dot", { radius: 6 }],
              anchor: ["Right"], paintStyle: { fill: "red" },
              isSource: true,
              connectionType: "red-connection"
            });

          }
          else {
            instance.addEndpoint(id, {
              endpoint: ["Dot", { radius: 6 }], maxConnections: 2,
              anchor: ["Right"], paintStyle: { fill: "red" },
              isSource: true,
              connectionType: "red-connection"
            });

            instance.addEndpoint(id, {
              endpoint: ["Dot", { radius: 6 }], maxConnections: 2,
              anchor: ["Left"],
              isTarget: true,
              connectionType: "red-connection"
            });
          }
        }
      })

    });



    /*var slider = document.getElementById("myRange");
    
    
    
    slider.oninput = function() {
      data3 = this.value;
      output.innerHTML = this.value;
    }*/


    document.getElementsByTagName("button")[0].onclick = contagem;

    function contagem() {

      var allConnections = instance.getConnections({
        //scope: "someScope"
      });
      var p_top=document.querySelector('#diagram').getBoundingClientRect().top;
    var p_left=document.querySelector('#diagram').getBoundingClientRect().left;
      const Tid = []; const Sid = [];
      //alert(allConnections.length);
      for (var i = 0; i < allConnections.length; i++) {
        var target = allConnections[i].targetId;
        var source = allConnections[i].sourceId;
        Tid[i] = target;
        Sid[i] = source;
      }
      const set1 = new Set();
      for (var i = 0; i < Tid.length; i++) {
        set1.add(Tid[i]);
      }
      const arr = [...set1].sort();
      const set_1 = new Set(arr);
      const set2 = new Set();
      for (var i = 0; i < Sid.length; i++) {
        set2.add(Sid[i]);
      }
      const arr1 = [...set2].sort(); const arr_r = []; const arr_c = [];
      var c_r = 0, c_v = 0, c_c = 0, c_g = 0, s_v, j = 0, k = 0;
      for (var i = 0; i < arr1.length; i++) {
        if (arr1[i][0] == 'r') { c_r++; arr_r[j] = arr1[i]; j++; }
        else if (arr1[i][0] == 'v') { c_v++; s_v = arr1[i]; }
        else if (arr1[i][0] == 'c') { c_c++; arr_c[k] = arr1[i]; k++; }
        else
          c_g++;
      }
      const set_2 = new Set(arr1);
      console.log(arr_r);
      if (Tid.length != 10 || Sid.length != 10 || !setsAreEqual(set_1, set_2) || c_r != 4 || c_v != 1 || c_g != 1 || c_c != 2) {
        swal("Wrong Connections");
      }
      else {
        var amp = {};
        for (var i = 0; i < Sid.length; i++) {
          amp[Sid[i]] = amp[Sid[i]] || [];
          amp[Sid[i]].push(Tid[i]);
        }
        for (var i = 0; i < Tid.length; i++) {
          amp[Tid[i]] = amp[Tid[i]] || [];
          amp[Tid[i]].push(Sid[i]);
        }
        console.log(amp);
        const s_element = new Set();
        var s = amp[arr[2]][0];
        s_element.add(s);
        const r_pos = [], c_pos = [];
        if ((s[0] != 'r' && s[0] != 'c') || amp[s].length != 3 || (amp[s][0] != arr[7] && (amp[s][0][0] != 'c' && amp[s][0][0] != 'r'))) {
          swal("Wrong Connection");
        }
        else {
          if (amp[s][0] == arr[7] && s[0] == 'r') {

            var r_top = document.querySelector('#' + s + '').getBoundingClientRect().bottom-p_top;
            var r_left = document.querySelector('#' + s + '').getBoundingClientRect().left - p_left+10;
            r_pos[2] = [r_top, r_left];


            if (amp[s][2] != arr[2])
              s = amp[s][2];
            else
              s = amp[s][1];

            if ((s[0] != 'r' || amp[s].length != 2 || amp[s][1][0] != 'c') && (s[0] != 'c' || amp[s].length != 2 || amp[s][1][0] != 'r')) {
              swal("Wrong Connection");
            }
            else {

              r_top = document.querySelector('#' + s + '').getBoundingClientRect().bottom-p_top;
              r_left = document.querySelector('#' + s + '').getBoundingClientRect().left - p_left+10;
              if (s[0] == 'r')
                r_pos[0] = [r_top, r_left];

              else {
                c_pos[0] = [r_top, r_left];
              }




              s = amp[s][1];
              if ((s[0] != 'c' || amp[s].length != 2 || amp[s][1] != arr[7]) && (s[0] != 'r' || amp[s].length != 2 || amp[s][1] != arr[7])) {
                swal("Wrong Connection");
              }
              else {

                r_top = document.querySelector('#' + s + '').getBoundingClientRect().bottom-p_top;
                r_left = document.querySelector('#' + s + '').getBoundingClientRect().left - p_left+10;
                if (s[0] == 'r')
                  r_pos[0] = [r_top, r_left];

                else {
                  c_pos[0] = [r_top, r_left];
                }



                s = amp[arr[2]][1];
                if ((s[0] != 'r' || amp[s].length != 3 || amp[s][2][0] != 'c') && (s[0] != 'c' || amp[s].length != 3 || amp[s][2][0] != 'r')) {
                  swal("Wrong Connection");
                }
                else {

                  r_top = document.querySelector('#' + s + '').getBoundingClientRect().bottom-p_top;
                  r_left = document.querySelector('#' + s + '').getBoundingClientRect().left - p_left+10;
                  if (s[0] == 'r')
                    r_pos[1] = [r_top, r_left];

                  else {
                    c_pos[1] = [r_top, r_left];
                  }



                  s = amp[s][2];
                  if ((s[0] != 'c' || amp[s].length != 2 || amp[s][1] != arr[7]) && (s[0] != 'r' || amp[s].length != 2 || amp[s][1] != arr[7])) {
                    swal("Wrong Connection");
                  }

                  else {

                    r_top = document.querySelector('#' + s + '').getBoundingClientRect().bottom-p_top;
                    r_left = document.querySelector('#' + s + '').getBoundingClientRect().left - p_left+10;
                    if (s[0] == 'r')
                      r_pos[1] = [r_top, r_left];

                    else {
                      c_pos[1] = [r_top, r_left];
                    }





                    if (amp[amp[s][0]][1] != arr[2])
                      s = amp[amp[s][0]][1];
                    else
                      s = amp[amp[s][0]][0];
                    if (s[0] != 'r' || amp[s].length != 2 || amp[s][0] != arr[7]) {
                      swal("Wrong Connection");
                    }

                    else {

                      r_top = document.querySelector('#' + s + '').getBoundingClientRect().bottom-p_top;
                      r_left = document.querySelector('#' + s + '').getBoundingClientRect().left - p_left+10;
                      r_pos[3] = [r_top, r_left];


                      swal("Right Connections...Go Ahead!!");

                      c_ratio = Math.max(Math.floor((Math.random() * 5) + 1), 1);
                      console.log(c_ratio);
                      var f = document.getElementById("btn1");
                      f.removeAttribute("disabled")






                      var v_top = document.querySelector('#' + s_v + '').getBoundingClientRect().bottom-p_top;
                      var v_left = document.querySelector('#' + s_v + '').getBoundingClientRect().left - p_left+10;

                      $("<div id='abcd' style = 'position: absolute;top:" + v_top + "px ; left:" + v_left + "px ;'><b>+  V,f  -</b></div>")
                        .appendTo("#diagram");


                      for (var i = 0; i < 4; i++) {
                        $("<b><div id='r1_tag" + i + "' style = 'position: absolute;top:" + r_pos[i][0] + "px ; left:" + r_pos[i][1] + "px ;'>R" + (i + 1) + "</div></b>")
                          .appendTo("#diagram");
                      }


                      $("<b><div id='c1_tag0' style = 'position: absolute;top:" + c_pos[0][0] + "px ; left:" + c_pos[0][1] + "px ;'>C" + 1 + "</div></b>")
                        .appendTo("#diagram");
                      $("<b><div id='c1_tag1' style = 'position: absolute;top:" + c_pos[1][0] + "px ; left:" + c_pos[1][1] + "px ;'>C" + 2 + "= 0.001uF</div></b>")
                        .appendTo("#diagram");




                      mydiv.style.display = "block";

                      var div1 = document.getElementById("diagram");
                      var div2 = document.getElementById("toolbox");

                      div1.classList.add("no-pointer-events");
                      div2.classList.add("no-pointer-events");


                    }




                  }
                }
              }

            }


          }

          else {

            console.log("Entered zone-1");

            r_top = document.querySelector('#' + s + '').getBoundingClientRect().bottom-p_top;
            r_left = document.querySelector('#' + s + '').getBoundingClientRect().left - p_left+10;

            if (s[0] == 'r')
              r_pos[0] = [r_top, r_left];

            else {
              c_pos[0] = [r_top, r_left];
            }


            if (amp[s][2] != arr[2])
              s = amp[s][2];
            else
              s = amp[s][1];

            if (s[0] != 'r' || amp[s].length != 2 || amp[s][1] != arr[7]) {
              swal("Wrong Connection");
            }
            else {

              r_top = document.querySelector('#' + s + '').getBoundingClientRect().bottom-p_top;
              r_left = document.querySelector('#' + s + '').getBoundingClientRect().left - p_left+10;
              r_pos[2] = [r_top, r_left];



              s = amp[arr[2]][1];
              if (s[0] != 'r' || amp[s].length != 3 || amp[s][2] != arr[7]) {
                swal("Wrong Connection");
              }
              else {

                r_top = document.querySelector('#' + s + '').getBoundingClientRect().bottom-p_top;
                r_left = document.querySelector('#' + s + '').getBoundingClientRect().left - p_left+10;
                r_pos[3] = [r_top, r_left];





                if (amp[s][0] != arr[2])
                  s = amp[s][0];
                else
                  s = amp[s][1];

                if ((s[0] != 'r' || amp[s].length != 2 || amp[s][0][0] != 'c') && (s[0] != 'c' || amp[s].length != 2 || amp[s][0][0] != 'r')) {
                  swal("Wrong Connection");
                }
                else {

                  r_top = document.querySelector('#' + s + '').getBoundingClientRect().bottom-p_top;
                  r_left = document.querySelector('#' + s + '').getBoundingClientRect().left - p_left+10;
                  if (s[0] == 'r')
                    r_pos[1] = [r_top, r_left];

                  else {
                    c_pos[1] = [r_top, r_left];
                  }




                  s = amp[s][0];
                  if ((s[0] != 'c' || amp[s].length != 2 || amp[s][0] != arr[7]) && (s[0] != 'r' || amp[s].length != 2 || amp[s][0] != arr[7])) {
                    swal("Wrong Connection");
                  }

                  else {

                    r_top = document.querySelector('#' + s + '').getBoundingClientRect().bottom-p_top;
                    r_left = document.querySelector('#' + s + '').getBoundingClientRect().left - p_left+10;
                    if (s[0] == 'r')
                      r_pos[1] = [r_top, r_left];

                    else {
                      c_pos[1] = [r_top, r_left];
                    }




                    s = amp[amp[arr[2]][0]][0];
                    if ((s[0] != 'c' || amp[s].length != 2 || amp[s][0] != arr[7]) && (s[0] != 'r' || amp[s].length != 2 || amp[s][0] != arr[7])) {
                      swal("Wrong Connection");
                    }
                    else {

                      r_top = document.querySelector('#' + s + '').getBoundingClientRect().bottom-p_top;
                      r_left = document.querySelector('#' + s + '').getBoundingClientRect().left - p_left+10;
                      if (s[0] == 'r')
                        r_pos[0] = [r_top, r_left];

                      else {
                        c_pos[0] = [r_top, r_left];
                      }





                      swal("Right Connections...Go Ahead!!");

                      var v_top = document.querySelector('#' + s_v + '').getBoundingClientRect().bottom-p_top;
                      var v_left = document.querySelector('#' + s_v + '').getBoundingClientRect().left - p_left+10;

                      $("<div id='abcd' style = 'position: absolute;top:" + v_top + "px ; left:" + v_left + "px ;'><b>+ V,f -</b></div>")
                        .appendTo("#diagram");



                      for (var i = 0; i < 4; i++) {
                        $("<div id='r1_tag' style = 'position: absolute;top:" + r_pos[i][0] + "px ; left:" + r_pos[i][1] + "px ;'><b>R" + (i + 1) + "</b></div>")
                          .appendTo("#diagram");
                      }


                      $("<div id='r1_tag' style = 'position: absolute;top:" + c_pos[0][0] + "px ; left:" + c_pos[0][1] + "px ;'><b>C" + 1 + "(unknown)</b></div>")
                        .appendTo("#diagram");
                      $("<div id='r1_tag' style = 'position: absolute;top:" + c_pos[1][0] + "px ; left:" + c_pos[1][1] + "px ;'><b>C" + 2 + "</b></div>")
                        .appendTo("#diagram");



                      mydiv.style.display = "block";

                      var div1 = document.getElementById("diagram");
                      var div2 = document.getElementById("toolbox");

                      div1.classList.add("no-pointer-events");
                      div2.classList.add("no-pointer-events");




                    }
                  }


                }



              }





            }

          }

        }


      }


      //jsPlumb.removeAllEndpoints("item_input");
    }
    function setsAreEqual(a, b) {
      if (a.size !== b.size) {
        return false;
      }

      return Array.from(a).every(element => {
        return b.has(element);
      });
    }

  </script>
</body>

</html>
